<!DOCTYPE html>
  <head>
      <h1> Занимательная алхимия </h1>
  </head>
  <body>
		<table>
    	<thead>
				<tr>
					<th colspan="2"> Параметры и ограничения </th>
				</tr>
    	</thead>
    	<tbody>
				<tr>
					<td> Ограничение времени </td>
					<td> 2 секунды </td>
        </tr>
				<tr>
					<td> Ограничение памяти </td>
					<td> 512Mb </td>
        </tr>
				<tr>
					<td> Ввод </td>
					<td> стандартный ввод или input.txt </td>
        </tr>
				<tr>
					<td> Вывод </td>
					<td> стандартный вывод или output.txt </td>
        </tr>
    	</tbody>
		</table>
		<p> 
			На рынке зелий произошёл бум и практически в каждом доме появилась своя алхимическая лаборатория. <br>
			Ресурсы подобных индивидуальных предпринимателей невелики, и их инструментарий сильно ограничен. <br>
			В результате долгих экспериментов были открыты два универсальных ингредиента для зелий (назовем их A и B), которые оказались доступны любому начинающему алхимику. <br>
			Отныне рецепт любого зелья можно свести к этим двум компонентам - зелье состоит из чистых ингредиентов A и/или B, из других зелий или из смеси чистых ингредиентов и зелий. <br>
			Одно зелье может требовать несколько экземпляров одного и того же ингредиента / зелья. <br>
			Ваш близкий друг Тирания Вампадур только начинает свой путь в алхимии и каждый день задаёт вам Q вопросов вида: если в её подвале осталось X единиц ингредиента A и Y единиц ингредиента B, может ли она изготовить один пузырёк зелья номер S? <br>
			Для облегчения своей жизни, вы решаете написать программу, отвечающую на подобные вопросы и подарить её Тирании. <br>
			Важно отметить, что некоторые рецепты были записаны со слов почётных алхимиков города, чья память знавала и лучшие времена. <br>
			Поэтому рецепты для некоторых зелий могут быть записаны неправильно и содержать циклы — такие зелья изготовить никак нельзя.
		</p>
  	<h2> Формат ввода </h2>
  	<p> 
			В первой строке дано число N (3 ≤ N ≤ 200000) — общее количество ингредиентов и рецептов производных зелий. <br>
			Ингредиент A имеет номер 1, B — номер 2, все производные зелья пронумерованы от 3 до N. <br>
  		Следующие N−2 строк содержат информацию о создании зелий: в i-й строке содержится список составных частей для зелья i+2. <br>
  		Первое число в строке Ki — количество составных частей. Далее через пробел следуют Ki чисел P<sub> ij </sub> (1 ≤ P<sub> ij </sub> ≤ N, 1 ≤ j ≤ K<sub> i </sub>) — номера составных частей для изготовления зелья i+2. <br>
  		Составные части в строке могут повторяться — каждая часть учитывается столько раз, сколько указана. <br>
  		Гарантируется, что ∑K <sub> i </sub> ≤ 1000000. <br>
  		В следующей строке задано одно целое число Q (1 ≤ Q ≤ 200000) — количество вопросов Тирании. <br>
  		Каждый вопрос задаётся в отдельной строке в формате XYS (0 ≤ X, Y ≤ 10 <sup> 9 </sup>, 3 ≤ S ≤ N) — количество ингредиентов A и B в подвале соответственно, а также номер запрашиваемого для изготовления зелья. 
		</p>
    <h2> Формат вывода </h2>
		<p> 
			В единственной строке выведите строку из Q символов: 
    	<ul>
      	<li> 1, если можно изготовить зелье из имеющегося количества ингредиентов; </li>
      	<li> 0 в любом ином случае. </li>
    	</ul>
    </p>
		<h2> Примеры </h2>
		<table>
    	<thead>
				<tr>
					<th> Ввод </th> <th> Вывод </th>
				</tr>
    	</thead>
    	<tbody>
				<tr>
					<td> 7 <br>
               3 1 1 2 <br>
               2 1 3 <br>
               3 4 3 4 <br>
               1 7 <br>
               1 6 <br>
               3 <br>
               8 4 5 <br>
               9 2 5 <br>
               10 10 6 </td>
					<td> 100 </td>
        </tr>
    	</tbody>
		</table>
    <h2> Примечания </h2>
    <p> 
			В приведенном тестовом примере есть 5 зелий и 2 чистых ингредиента:
    	<ul>
      	<li> Зелье 3 требует для создания два ингредиента A и один ингредиент B; </li>
      	<li> Зелье 4 требует один ингредиент A и одно зелье 3 — значит суммарно три ингредиента A и один ингредиент B; </li>
      	<li> Зелье 5 требует два зелья 4 и одно зелье 3 — суммарно восемь ингредиентов A и три ингредиента B; </li>
      	<li> Зелья 6 и 7 ссылаются друг на друга в рецептах — судя по всему, что-то перепуталось при записи и в данный момент изготовить их никак нельзя. </li>
    	</ul>
    	В первом вопросе Тиранию интересует, можно ли изготовить зелье 5, имея ровно 8 ингредиентов A и 4 ингредиента B. <br>
    	Как мы выяснили выше, для изготовления зелья 5 требуется как раз 8 ингредиентов A и 3 ингредиента B — значит зелье изготовить можно. <br>
			Второй вопрос Тирания задаёт также про зелье 5, но теперь ингредиентов A — целых 9, в то время как ингредиентов B всего 2. <br>
			Хотя ингредиентов A хватает с избытком, но ингредиентов B не хватает (нужно 3), поэтому изготовить зелье нельзя. <br>
    	В третий раз Тирания спрашивает вас о зелье 6 — вы уже знаете, что независимо от количества ингредиентов это зелье изготовить не получится никак из-за циклической зависимости в рецептуре. <br>
		</p>
		<h2> </h2>
		<p><b> 
			Компилятор: GNU C++20 10.2 <br>
			Вердикт: Превышен лимит использования памяти <br>
			Статус: Частичное решение <br>
			Время: 1.304s <br>
			Память: 570.84Mb <br>
			Крайний тест: 10 
		</b></p>
  </body>
</html>	
